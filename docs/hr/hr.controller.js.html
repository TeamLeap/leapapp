<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width" charset="utf-8">
    <title>My Project</title>
    <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/cayman.min.css">
    <link rel="stylesheet" href="../css/prism.min.css">
    <link rel="stylesheet" href="../css/index.min.css">
    <link rel="stylesheet" href="../css/docs.min.css">
    <link rel="stylesheet" href="../css/bootstrap-responsive.min.css">
  </head>
  <body data-spy="scroll" data-target=".scrollspy">
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container"><a class="brand">Mr. Doc</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right sponsored"></ul>
          </div>
        </div>
      </div>
    </div>
    <header id="overview" class="jumbotron subhead">
      <div class="container">
        <h1>My Project</h1>
        <p class="lead"></p>
      </div>
    </header>
    <div class="container">
      <div class="row">
        <div class="span3 bs-docs-sidebar">
          <ul class="nav nav-list bs-docs-sidenav affix-top">
            <li><a href="../index.html">Main</a></li>
            <li><a href="../bower_components/Chart.js.html">bower_components/Chart.js</a></li>
            <li><a href="../bower_components/Chart.js/dist/Chart.bundle.js.html">bower_components/Chart.js/dist/Chart.bundle.js</a></li>
            <li><a href="../bower_components/Chart.js/dist/Chart.bundle.min.js.html">bower_components/Chart.js/dist/Chart.bundle.min.js</a></li>
            <li><a href="../bower_components/Chart.js/dist/Chart.js.html">bower_components/Chart.js/dist/Chart.js</a></li>
            <li><a href="../bower_components/Chart.js/dist/Chart.min.js.html">bower_components/Chart.js/dist/Chart.min.js</a></li>
            <li><a href="../bower_components/Chart.js/gulpfile.js.html">bower_components/Chart.js/gulpfile.js</a></li>
            <li><a href="../bower_components/Chart.js/karma.conf.ci.js.html">bower_components/Chart.js/karma.conf.ci.js</a></li>
            <li><a href="../bower_components/Chart.js/karma.conf.js.html">bower_components/Chart.js/karma.conf.js</a></li>
            <li><a href="../bower_components/Chart.js/karma.coverage.conf.js.html">bower_components/Chart.js/karma.coverage.conf.js</a></li>
            <li><a href="../bower_components/Chart.js/src/chart.js.html">bower_components/Chart.js/src/chart.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.Bar.js.html">bower_components/Chart.js/src/charts/Chart.Bar.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.Bubble.js.html">bower_components/Chart.js/src/charts/Chart.Bubble.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.Doughnut.js.html">bower_components/Chart.js/src/charts/Chart.Doughnut.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.Line.js.html">bower_components/Chart.js/src/charts/Chart.Line.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.PolarArea.js.html">bower_components/Chart.js/src/charts/Chart.PolarArea.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.Radar.js.html">bower_components/Chart.js/src/charts/Chart.Radar.js</a></li>
            <li><a href="../bower_components/Chart.js/src/charts/Chart.Scatter.js.html">bower_components/Chart.js/src/charts/Chart.Scatter.js</a></li>
            <li><a href="../bower_components/Chart.js/src/controllers/controller.bar.js.html">bower_components/Chart.js/src/controllers/controller.bar.js</a></li>
            <li><a href="../bower_components/Chart.js/src/controllers/controller.bubble.js.html">bower_components/Chart.js/src/controllers/controller.bubble.js</a></li>
            <li><a href="../bower_components/Chart.js/src/controllers/controller.doughnut.js.html">bower_components/Chart.js/src/controllers/controller.doughnut.js</a></li>
            <li><a href="../bower_components/Chart.js/src/controllers/controller.line.js.html">bower_components/Chart.js/src/controllers/controller.line.js</a></li>
            <li><a href="../bower_components/Chart.js/src/controllers/controller.polarArea.js.html">bower_components/Chart.js/src/controllers/controller.polarArea.js</a></li>
            <li><a href="../bower_components/Chart.js/src/controllers/controller.radar.js.html">bower_components/Chart.js/src/controllers/controller.radar.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.animation.js.html">bower_components/Chart.js/src/core/core.animation.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.controller.js.html">bower_components/Chart.js/src/core/core.controller.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.datasetController.js.html">bower_components/Chart.js/src/core/core.datasetController.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.element.js.html">bower_components/Chart.js/src/core/core.element.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.helpers.js.html">bower_components/Chart.js/src/core/core.helpers.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.js.html">bower_components/Chart.js/src/core/core.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.layoutService.js.html">bower_components/Chart.js/src/core/core.layoutService.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.legend.js.html">bower_components/Chart.js/src/core/core.legend.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.plugin.js.html">bower_components/Chart.js/src/core/core.plugin.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.scale.js.html">bower_components/Chart.js/src/core/core.scale.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.scaleService.js.html">bower_components/Chart.js/src/core/core.scaleService.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.title.js.html">bower_components/Chart.js/src/core/core.title.js</a></li>
            <li><a href="../bower_components/Chart.js/src/core/core.tooltip.js.html">bower_components/Chart.js/src/core/core.tooltip.js</a></li>
            <li><a href="../bower_components/Chart.js/src/elements/element.arc.js.html">bower_components/Chart.js/src/elements/element.arc.js</a></li>
            <li><a href="../bower_components/Chart.js/src/elements/element.line.js.html">bower_components/Chart.js/src/elements/element.line.js</a></li>
            <li><a href="../bower_components/Chart.js/src/elements/element.point.js.html">bower_components/Chart.js/src/elements/element.point.js</a></li>
            <li><a href="../bower_components/Chart.js/src/elements/element.rectangle.js.html">bower_components/Chart.js/src/elements/element.rectangle.js</a></li>
            <li><a href="../bower_components/Chart.js/src/scales/scale.category.js.html">bower_components/Chart.js/src/scales/scale.category.js</a></li>
            <li><a href="../bower_components/Chart.js/src/scales/scale.linear.js.html">bower_components/Chart.js/src/scales/scale.linear.js</a></li>
            <li><a href="../bower_components/Chart.js/src/scales/scale.logarithmic.js.html">bower_components/Chart.js/src/scales/scale.logarithmic.js</a></li>
            <li><a href="../bower_components/Chart.js/src/scales/scale.radialLinear.js.html">bower_components/Chart.js/src/scales/scale.radialLinear.js</a></li>
            <li><a href="../bower_components/Chart.js/src/scales/scale.time.js.html">bower_components/Chart.js/src/scales/scale.time.js</a></li>
            <li><a href="../bower_components/angular/angular.js.html">bower_components/angular/angular.js</a></li>
            <li><a href="../bower_components/angular/angular.min.js.html">bower_components/angular/angular.min.js</a></li>
            <li><a href="../bower_components/angular/index.js.html">bower_components/angular/index.js</a></li>
            <li><a href="../bower_components/angular-charts/dist/angular-charts.js.html">bower_components/angular-charts/dist/angular-charts.js</a></li>
            <li><a href="../bower_components/angular-charts/dist/angular-charts.min.js.html">bower_components/angular-charts/dist/angular-charts.min.js</a></li>
            <li><a href="../bower_components/angular-nvd3/Gruntfile.js.html">bower_components/angular-nvd3/Gruntfile.js</a></li>
            <li><a href="../bower_components/angular-nvd3/dist/angular-nvd3.js.html">bower_components/angular-nvd3/dist/angular-nvd3.js</a></li>
            <li><a href="../bower_components/angular-nvd3/dist/angular-nvd3.min.js.html">bower_components/angular-nvd3/dist/angular-nvd3.min.js</a></li>
            <li><a href="../bower_components/angular-nvd3/index.js.html">bower_components/angular-nvd3/index.js</a></li>
            <li><a href="../bower_components/d3/d3.js.html">bower_components/d3/d3.js</a></li>
            <li><a href="../bower_components/d3/d3.min.js.html">bower_components/d3/d3.min.js</a></li>
            <li><a href="../bower_components/nvd3/build/nv.d3.js.html">bower_components/nvd3/build/nv.d3.js</a></li>
            <li><a href="../bower_components/nvd3/build/nv.d3.min.js.html">bower_components/nvd3/build/nv.d3.min.js</a></li>
            <li><a href="../bower_components/nvd3/meteor/export.js.html">bower_components/nvd3/meteor/export.js</a></li>
            <li><a href="../bower_components/nvd3/package.js.html">bower_components/nvd3/package.js</a></li>
            <li><a href="../cemetery/cemetery.controller.js.html">cemetery/cemetery.controller.js</a></li>
            <li><a href="../counsellor/counsellor.controller.js.html">counsellor/counsellor.controller.js</a></li>
            <li><a href="../docs/js/bootstrap-affix.min.js.html">docs/js/bootstrap-affix.min.js</a></li>
            <li><a href="../docs/js/bootstrap-collapse.min.js.html">docs/js/bootstrap-collapse.min.js</a></li>
            <li><a href="../docs/js/bootstrap-dropdown.min.js.html">docs/js/bootstrap-dropdown.min.js</a></li>
            <li><a href="../docs/js/bootstrap-scrollspy.min.js.html">docs/js/bootstrap-scrollspy.min.js</a></li>
            <li><a href="../docs/js/bootstrap-transition.min.js.html">docs/js/bootstrap-transition.min.js</a></li>
            <li><a href="../docs/js/index.min.js.html">docs/js/index.min.js</a></li>
            <li><a href="../docs/js/jquery.min.js.html">docs/js/jquery.min.js</a></li>
            <li><a href="../docs/js/prism.min.js.html">docs/js/prism.min.js</a></li>
            <li><a href="../docs/js/twitter-widget.min.js.html">docs/js/twitter-widget.min.js</a></li>
            <li><a href="../efleet/efleet.controller.js.html">efleet/efleet.controller.js</a></li>
            <li><a href="../ehealth/ehealth.controller.js.html">ehealth/ehealth.controller.js</a></li>
            <li><a href="../gulpfile.js.html">gulpfile.js</a></li>
            <li class="active"><a href="../hr/hr.controller.js.html">hr/hr.controller.js</a></li>
            <li><a href="../indigent/indigent.controller.js.html">indigent/indigent.controller.js</a></li>
            <li><a href="../js/app.js.html">js/app.js</a></li>
            <li><a href="../js/config.js.html">js/config.js</a></li>
            <li><a href="../js/map-icons.js.html">js/map-icons.js</a></li>
            <li><a href="../js/ng-cordova.js.html">js/ng-cordova.js</a></li>
            <li><a href="../js/oauth.js.html">js/oauth.js</a></li>
            <li><a href="../js/plugins.js.html">js/plugins.js</a></li>
            <li><a href="../js/ui-bootstrap-tpls-2.1.1.js.html">js/ui-bootstrap-tpls-2.1.1.js</a></li>
            <li><a href="../lib/angular-messages.min.js.html">lib/angular-messages.min.js</a></li>
            <li><a href="../lib/angular-nvd3.js.html">lib/angular-nvd3.js</a></li>
            <li><a href="../lib/angular.soap.js.html">lib/angular.soap.js</a></li>
            <li><a href="../lib/d3.js.html">lib/d3.js</a></li>
            <li><a href="../lib/nv.d3.js.html">lib/nv.d3.js</a></li>
            <li><a href="../lib/onsen/js/angular/angular-animate.js.html">lib/onsen/js/angular/angular-animate.js</a></li>
            <li><a href="../lib/onsen/js/angular/angular-touch.js.html">lib/onsen/js/angular/angular-touch.js</a></li>
            <li><a href="../lib/onsen/js/angular/angular.js.html">lib/onsen/js/angular/angular.js</a></li>
            <li><a href="../lib/onsen/js/angular/angular.min.js.html">lib/onsen/js/angular/angular.min.js</a></li>
            <li><a href="../lib/onsen/js/jquery-3.1.0.min.js.html">lib/onsen/js/jquery-3.1.0.min.js</a></li>
            <li><a href="../lib/onsen/js/onsenui.js.html">lib/onsen/js/onsenui.js</a></li>
            <li><a href="../lib/onsen/js/onsenui.min.js.html">lib/onsen/js/onsenui.min.js</a></li>
            <li><a href="../lib/onsen/js/onsenui_all.js.html">lib/onsen/js/onsenui_all.js</a></li>
            <li><a href="../lib/onsen/js/onsenui_all.min.js.html">lib/onsen/js/onsenui_all.min.js</a></li>
            <li><a href="../lib/signature_pad.js.html">lib/signature_pad.js</a></li>
            <li><a href="../lib/soapclient.js.html">lib/soapclient.js</a></li>
            <li><a href="../lib/swiper.js.html">lib/swiper.js</a></li>
            <li><a href="../providers/services/twitter-provider.js.html">providers/services/twitter-provider.js</a></li>
            <li><a href="../suprema/suprema.controller.js.html">suprema/suprema.controller.js</a></li>
          </ul>
          <div class="scrollspy">
            <ul class="nav nav-list bs-docs-sidenav affix-top">
            </ul>
          </div>
        </div>
        <div class="span9">
          <div class="description"></div>
          <pre><code class="language-javascript">app.controller('hrController', ['$http', '$scope', '$rootScope', '$sce', 'appConfig', 'loadingMessageService', function ($http, $scope, $rootScope, $sce, appConfig, loadingMessageService) {

        $scope.aggregatedList = [];
        $scope.markers = [];
        $scope.employeeList = [];

        $scope.initHRInfo = function () {

            $scope.isFetching = true;
            $rootScope.didYouKnowMessage = loadingMessageService.showMessage();
            modal.show();


            d3.json(appConfig.emmHRinfoEndPoint, function (data) {

                $scope.employeeList = data.results;

                //Female
                var femaleList = {
                    key: &quot;Female&quot;,
                    color: &quot;#4f99b4&quot;,
                    values: []
                };

                var i;
                var count;
                for (i = 0; i &lt; data.results.length; i++) {

                    var count = data.results.reduce(function (n, person) {
                        return n + (person.TOWN_OR_CITY == data.results[i].TOWN_OR_CITY &amp;&amp; person.SEX == 'F');
                    }, 0);

                    femaleList.values.push({
                        value: count,
                        label: data.results[i].TOWN_OR_CITY
                    });
                }

                //Male
                var maleList = {
                    key: &quot;Male&quot;,
                    color: &quot;#00FF00&quot;,
                    values: []
                };

                var i;
                var count;
                for (i = 0; i &lt; data.results.length; i++) {

                    var count = data.results.reduce(function (n, person) {
                        return n + (person.TOWN_OR_CITY == data.results[i].TOWN_OR_CITY &amp;&amp; person.SEX == 'M');
                    }, 0);

                    maleList.values.push({
                        value: count,
                        label: data.results[i].TOWN_OR_CITY
                    });
                }

                $scope.maleHighValue = 0, $scope.femaleHighValue = 0;
                $scope.maleHighRegion = &quot;&quot;, $scope.femaleHighRegion = &quot;&quot;;

                for (i = 0; i &lt; maleList.values.length; i++) {

                    if (parseInt(maleList.values[i].value, 10) &gt; $scope.maleHighValue) {
                        $scope.maleHighValue = maleList.values[i].value;
                        $scope.maleHighRegion = maleList.values[i].label;
                    }

                };

                for (i = 0; i &lt; femaleList.values.length; i++) {

                    if (parseInt(femaleList.values[i].value, 10) &gt; $scope.femaleHighValue) {
                        $scope.femaleHighValue = femaleList.values[i].value;
                        $scope.femaleHighRegion = femaleList.values[i].label;
                    }

                };

                $scope.aggregatedList = [femaleList, maleList];

                $scope.$apply();


                nv.addGraph(function () {

                    var chart = nv.models.multiBarHorizontalChart()
                        .x(function (d) {
                            return d.label
                        })
                        .y(function (d) {
                            return d.value
                        })
                        .margin({
                            top: 55,
                            right: 5,
                            bottom: 5,
                            left: 65
                        })
                        .showValues(true) //Show bar value next to each bar.
                        //.tooltips(true) //Show tooltips on hover.
                        //.transitionDuration(350)
                        .showControls(false); //Allow user to switch between &quot;Grouped&quot; and &quot;Stacked&quot; mode.

                    chart.yAxis
                        .tickFormat(d3.format(',.0f'));

                    chart.groupSpacing(0);
                    chart.height(900);

                    d3.select('#chart1 svg')
                        .datum($scope.aggregatedList)
                        .call(chart);

                    nv.utils.windowResize(chart.update);

                    return chart;
                });

                $scope.isFetching = false;
                modal.hide();
            });

        }

        $scope.pullMarkersContent = function () {

            navigator.geolocation.getCurrentPosition(function (position) {

                $scope.userLat = position.coords.latitude;
                $scope.userLng = position.coords.longitude;

                $http.get('regions.json').success(function (response) {

                    $scope.locations = response.regions;

                    $.each($scope.locations, function (index, value) {

                        var distance = Haversine($scope.locations[index].geometry.location.lat, $scope.locations[index].geometry.location.lng, $scope.userLat, $scope.userLng);

                        $scope.markers.push({
                            'id': index,
                            'title': $scope.locations[index].section,
                            'content': $scope.locations[index].section,

                            'distance': (Math.round(distance * 100) / 100),
                            'location': [$scope.locations[index].geometry.location.lat, $scope.locations[index].geometry.location.lng],
                            'type': $scope.locations[index].type,
                            'icon': &quot;images/icons/mapicon.png&quot;

                        });

                    });

                });


                d3.json(appConfig.emmHRinfoEndPoint, function (data) {

                    $scope.employeeList = data.results;
                });

            }, function (error) {

                console.log(&quot;Couldn't get the location of the user.&quot;);

                ons.notification.alert({
                    message: 'Please enable you GPS and try again.!',
                    modifier: 'material'
                });

                modal.hide();

                console.log(error.code);

                $rootScope.goExit();

            }, {
                maximumAge: Infinity,
                timeout: 60000,
                enableHighAccuracy: true
            });

        }


        $scope.showMarker = function (event) {

            $scope.marker = $scope.markers[this.id];

            var count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title);
            }, 0);

            var femalecount = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.SEX == 'F');
            }, 0);

            var malecount = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.SEX == 'M');
            }, 0);

            var Over50count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.AGEGROUP == 'Over50');
            }, 0);

            var LessThan45count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.AGEGROUP == 'LessThan45');
            }, 0);

            var LessThan40count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.AGEGROUP == 'LessThan40');
            }, 0);

            var LessThan35count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.AGEGROUP == 'LessThan35');
            }, 0);

            var LessThan30count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.AGEGROUP == 'LessThan30');
            }, 0);

            var LessThan25count = $scope.employeeList.reduce(function (n, person) {
                return n + (person.TOWN_OR_CITY == $scope.marker.title &amp;&amp; person.AGEGROUP == 'LessThan25');
            }, 0);

            $scope.infoWindow = {
                id: $scope.marker.id,

                title: $scope.marker.title,
                content: 'There are ' + count + ' employees, ' + femalecount + ' females and ' + malecount + ' males. &lt;br&gt;&lt;br&gt; Age Group&lt;br&gt; 1. ' + Over50count + ' over 50 years. &lt;br&gt; 2. ' + LessThan45count + ' over 45 and less than 50 years. &lt;br&gt; 3. ' + LessThan40count + ' over 35 and less than 45 years. &lt;br&gt; 4. ' + LessThan35count + ' over 30 and less than 35 years. &lt;br&gt;5. ' + LessThan30count + ' over 25 and less than 30 years. &lt;br&gt;6. ' + LessThan25count + '  less than 25 years.',

                distance: $scope.marker.distance,
                location: $scope.marker.location,

            };
            $scope.$apply();
            $scope.showInfoWindow(event, 'marker-info', this.getPosition());

        }

        }]);</code></pre>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p>Documentation generated with <a href="https://github.com/mr-doc/mr-doc">Mr. Doc </a> created by <a href="https://twitter.com/FGRibreau" data-show-count="false" class="twitter-follow-button">Francois-Guillaume Ribreau </a></p>
        <p>Mr. Doc is sponsored by <a href="http://bringr.net/?btt" title="Outil d'analyse des réseaux sociaux" class="bringr">Bringr </a> and <a href="https://redsmin.com/?btt" title="Full Redis GUI" class="redsmin">Redsmin</a></p>
        <p>Theme borrowed from Twitter Bootstrap</p>
      </div>
    </footer>
    <script src="../js/twitter-widget.min.js"></script>
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bootstrap-transition.min.js"></script>
    <script src="../js/bootstrap-scrollspy.min.js"></script>
    <script src="../js/bootstrap-dropdown.min.js"></script>
    <script src="../js/bootstrap-collapse.min.js"></script>
    <script src="../js/bootstrap-affix.min.js"></script>
    <script src="../js/prism.min.js"></script>
    <script src="../js/index.min.js"></script>
  </body>
</html>